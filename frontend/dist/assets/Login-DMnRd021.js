import{j as e,u as J,H as R,t as b}from"./index-Dt5WERKu.js";import{r as i,R as $,u as V,N as z,L as O}from"./vendor-router-28i81ewO.js";import{H as Q}from"./Header-CETASENN.js";import{T as X}from"./trending-up-DgOLkZli.js";import{L as Z}from"./lock-DWYKTwz_.js";import{C as ee}from"./chart-line-COInPfjF.js";import{B as oe,C as te}from"./card-CIcDT7T4.js";import{I as W,A as F}from"./apiEndpoints-BSwOnRXW.js";import{L as U,E as re,a as ne}from"./label-W8SoZD98.js";import"./vendor-charts-BdN0zgE8.js";function se(t={}){const{nonce:o,onScriptLoadSuccess:r,onScriptLoadError:n}=t,[d,l]=i.useState(!1),u=i.useRef(r);u.current=r;const m=i.useRef(n);return m.current=n,i.useEffect(()=>{const s=document.createElement("script");return s.src="https://accounts.google.com/gsi/client",s.async=!0,s.defer=!0,s.nonce=o,s.onload=()=>{var c;l(!0),(c=u.current)===null||c===void 0||c.call(u)},s.onerror=()=>{var c;l(!1),(c=m.current)===null||c===void 0||c.call(m)},document.body.appendChild(s),()=>{document.body.removeChild(s)}},[o]),d}const K=i.createContext(null);function M({clientId:t,nonce:o,onScriptLoadSuccess:r,onScriptLoadError:n,children:d}){const l=se({nonce:o,onScriptLoadSuccess:r,onScriptLoadError:n}),u=i.useMemo(()=>({clientId:t,scriptLoadedSuccessfully:l}),[t,l]);return $.createElement(K.Provider,{value:u},d)}function ie(){const t=i.useContext(K);if(!t)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return t}function ae(t){var o;return(o=t?.clientId)!==null&&o!==void 0?o:t?.client_id}const le={large:40,medium:32,small:20};function ce({onSuccess:t,onError:o,useOneTap:r,promptMomentNotification:n,type:d="standard",theme:l="outline",size:u="large",text:m,shape:s,logo_alignment:c,width:j,locale:x,click_listener:f,containerProps:a,...g}){const p=i.useRef(null),{clientId:h,scriptLoadedSuccessfully:v}=ie(),S=i.useRef(t);S.current=t;const k=i.useRef(o);k.current=o;const P=i.useRef(n);return P.current=n,i.useEffect(()=>{var L,C,I,_,A,T,G,B,D;if(v)return(I=(C=(L=window?.google)===null||L===void 0?void 0:L.accounts)===null||C===void 0?void 0:C.id)===null||I===void 0||I.initialize({client_id:h,callback:w=>{var y;if(!w?.credential)return(y=k.current)===null||y===void 0?void 0:y.call(k);const{credential:E,select_by:Y}=w;S.current({credential:E,clientId:ae(w),select_by:Y})},...g}),(T=(A=(_=window?.google)===null||_===void 0?void 0:_.accounts)===null||A===void 0?void 0:A.id)===null||T===void 0||T.renderButton(p.current,{type:d,theme:l,size:u,text:m,shape:s,logo_alignment:c,width:j,locale:x,click_listener:f}),r&&((D=(B=(G=window?.google)===null||G===void 0?void 0:G.accounts)===null||B===void 0?void 0:B.id)===null||D===void 0||D.prompt(P.current)),()=>{var w,y,E;r&&((E=(y=(w=window?.google)===null||w===void 0?void 0:w.accounts)===null||y===void 0?void 0:y.id)===null||E===void 0||E.cancel())}},[h,v,r,d,l,u,m,s,c,j,x]),$.createElement("div",{...a,ref:p,style:{height:le[u],...a?.style}})}class N extends Error{}N.prototype.name="InvalidTokenError";function de(t){return decodeURIComponent(atob(t).replace(/(.)/g,(o,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function ue(t){let o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return de(o)}catch{return atob(o)}}function me(t,o){if(typeof t!="string")throw new N("Invalid token specified: must be a string");o||(o={});const r=o.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new N(`Invalid token specified: missing part #${r+1}`);let d;try{d=ue(n)}catch(l){throw new N(`Invalid token specified: invalid base64 for part #${r+1} (${l.message})`)}try{return JSON.parse(d)}catch(l){throw new N(`Invalid token specified: invalid json for part #${r+1} (${l.message})`)}}const ge=()=>{const t=[{icon:e.jsx(X,{size:28,className:"text-primary-strong"}),text:"Track real-time market insights"},{icon:e.jsx(Z,{size:28,className:"text-primary-strong"}),text:"Secure and reliable trading platform"},{icon:e.jsx(ee,{size:28,className:"text-primary-strong"}),text:"Advanced analytics and reporting"}];return e.jsx("div",{className:"flex-1 flex flex-col justify-center p-12 bg-muted text-card-foreground relative overflow-hidden",children:e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-4xl font-bold mb-10 font-display text-foreground",children:"Welcome to SnoopTrade"}),e.jsx("div",{className:"space-y-6",children:t.map((o,r)=>e.jsxs("div",{className:"flex items-center gap-4 transform transition-transform hover:translate-x-3 duration-300",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/20",children:o.icon}),e.jsx("p",{className:"text-lg text-muted-foreground",children:o.text})]},r))})]})})},pe=({onSubmit:t,error:o})=>{const[r,n]=i.useState(""),[d,l]=i.useState(""),[u,m]=i.useState(!1),[s,c]=i.useState(!1),j=async x=>{x.preventDefault(),c(!0),await t(r,d),c(!1)};return e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"email",className:"text-card-foreground",children:"Email"}),e.jsx(W,{id:"email",type:"email",placeholder:"Enter your email",value:r,onChange:x=>n(x.target.value),required:!0,className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(U,{htmlFor:"password",className:"text-card-foreground",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{id:"password",type:u?"text":"password",placeholder:"Enter your password",value:d,onChange:x=>l(x.target.value),required:!0,className:"h-11 pr-10"}),e.jsx("button",{type:"button",onClick:()=>m(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-primary-strong transition-colors",children:u?e.jsx(re,{size:20}):e.jsx(ne,{size:20})})]})]}),o&&e.jsx("div",{role:"alert",className:"login-error-message bg-destructive/30 border border-destructive text-sm p-3 rounded-md text-center font-medium",children:o}),e.jsx(oe,{type:"submit",disabled:s,className:"w-full h-12 text-base font-semibold",children:s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}),e.jsx("span",{children:"Signing in..."})]}):"Sign In"})]})},q=({onSuccess:t,onError:o})=>{const r=i.useRef(null),[n,d]=i.useState(400),[l,u]=i.useState(0),m=i.useCallback(()=>{if(r.current){const s=Math.floor(r.current.offsetWidth);s>0&&s!==n&&(d(s),u(c=>c+1))}},[n]);return i.useEffect(()=>{m();const s=new ResizeObserver(()=>m());return r.current&&s.observe(r.current),()=>s.disconnect()},[m]),e.jsx("div",{ref:r,className:"w-full",children:e.jsx(ce,{onSuccess:t,onError:o,text:"signin_with",shape:"rectangular",theme:"outline",size:"large",width:n},l)})},H="728674119061-9r5tbp1mactot2uf1p7q44bp0g7sg4p5.apps.googleusercontent.com",Ne=()=>{const[t,o]=i.useState(""),r=V(),{token:n,setToken:d,requiresPassword:l,setRequiresPassword:u}=J(),m=async(f,a)=>{try{const g=new URLSearchParams;g.append("username",f),g.append("password",a);const p=await fetch(F.login,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:g.toString()});if(p.ok){const h=await p.json();d(h.access_token),b.success("Welcome back!",{description:"You have been logged in successfully."}),r("/dashboard")}else{const v=(await p.json()).detail||"Login failed. Please try again.";o(v),b.error("Login failed",{description:v})}}catch{const p="Something went wrong. Please try again.";o(p),b.error("Connection error",{description:p})}},s=async f=>{try{const a=f.credential;if(!a){o("Google token is missing or invalid.");return}const g=me(a);if(!g.email){o("Google token does not contain email information.");return}const p=new URLSearchParams;p.append("username",g.email),p.append("password",""),p.append("login_type","google"),p.append("token",a);const h=await fetch(F.login,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:p.toString()});if(h.ok){const v=await h.json();d(v.access_token),v.requires_password?(u(!0),r("/create-password")):(b.success("Welcome back!",{description:"Signed in with Google."}),r("/dashboard"))}else{const S=(await h.json()).detail||"Google login failed.";o(S),b.error("Google login failed",{description:S})}}catch(a){console.error("Error in Google login:",a);const g="Something went wrong with Google login.";o(g),b.error("Google login error",{description:g})}},c=()=>{o("Google Login failed."),b.error("Google Login failed",{description:"Please try again or use email login."})};if(n&&!l)return e.jsx(z,{to:"/dashboard",replace:!0});if(n&&l)return e.jsx(z,{to:"/create-password",replace:!0});const j=e.jsxs("div",{className:"min-h-screen flex flex-col px-5 pt-12 pb-8 md:hidden",style:{backgroundColor:"#0E1410"},children:[e.jsx(R,{children:e.jsx("title",{children:"Login - SnoopTrade"})}),e.jsxs("div",{className:"mb-8",style:{gap:8},children:[e.jsx("p",{style:{color:"#A7B7AC",fontSize:12,fontWeight:600,marginBottom:8},children:"SnoopTrade"}),e.jsx("h1",{style:{color:"#EAF5EC",fontSize:28,fontWeight:700,marginBottom:8},children:"Welcome back"}),e.jsx("p",{style:{color:"#A7B7AC",fontSize:15},children:"Sign in to track insider activity."})]}),e.jsx(M,{clientId:H,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("div",{className:"mobile-input",children:e.jsx("input",{type:"email",placeholder:"Email",style:{width:"100%",background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15},onKeyDown:f=>{if(f.key==="Enter"){const a=document.getElementById("mobile-password");a&&a.focus()}},id:"mobile-email"})}),e.jsx("div",{className:"mobile-input",children:e.jsx("input",{type:"password",placeholder:"Password",style:{width:"100%",background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15},id:"mobile-password",onKeyDown:f=>{if(f.key==="Enter"){const a=document.getElementById("mobile-email"),g=document.getElementById("mobile-password");a?.value&&g?.value&&m(a.value,g.value)}}})}),t&&e.jsx("p",{style:{color:"#E56A6A",fontSize:12,marginTop:4},children:t}),e.jsx("button",{className:"mobile-btn-primary",style:{marginTop:12},onClick:()=>{const f=document.getElementById("mobile-email"),a=document.getElementById("mobile-password");m(f?.value||"",a?.value||"")},children:"Login"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginTop:12},children:[e.jsx("div",{style:{flex:1,height:1,backgroundColor:"#314036"}}),e.jsx("span",{style:{color:"#A7B7AC",fontSize:12},children:"OR"}),e.jsx("div",{style:{flex:1,height:1,backgroundColor:"#314036"}})]}),e.jsx("div",{style:{marginTop:12,width:"100%"},children:e.jsx(q,{onSuccess:s,onError:c})}),e.jsxs("p",{style:{textAlign:"center",marginTop:24,color:"#A7B7AC",fontSize:15},children:["No account yet?"," ",e.jsx(O,{to:"/signup",style:{color:"#B7E389",fontWeight:700,textDecoration:"none"},children:"Sign up"})]})]})})]}),x=e.jsxs("div",{className:"min-h-screen lg:fixed lg:inset-0 lg:h-screen lg:overflow-hidden hidden md:flex flex-col items-center bg-background pt-24 sm:pt-28 md:pt-32 lg:pt-24",children:[e.jsx(R,{children:e.jsx("title",{children:"Login - SnoopTrade"})}),e.jsx(Q,{}),e.jsx(M,{clientId:H,children:e.jsx("div",{className:"animate-in fade-in duration-1000 flex-1 flex flex-col min-h-0 items-center justify-center px-4 py-6 lg:py-4 w-[92%] sm:w-[85%] lg:w-[75%] max-w-[1200px] mb-8 sm:mb-12 lg:mb-0",children:e.jsxs(te,{className:"flex flex-col md:flex-row overflow-hidden rounded-xl sm:rounded-2xl shadow-2xl bg-card border-border max-h-[calc(100vh-8rem)] lg:max-h-[calc(100vh-6rem)]",children:[e.jsx(ge,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-5 sm:p-8 md:p-12 bg-card min-h-0 overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-md space-y-4 sm:space-y-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-center text-card-foreground font-display",children:"Login to Your Account"}),e.jsx(pe,{onSubmit:m,error:t}),e.jsxs("div",{className:"flex items-center my-4 sm:my-6",children:[e.jsx("div",{className:"flex-1 border-b border-border"}),e.jsx("span",{className:"px-4 text-sm text-muted-foreground",children:"OR"}),e.jsx("div",{className:"flex-1 border-b border-border"})]}),e.jsx("div",{className:"w-full",children:e.jsx(q,{onSuccess:s,onError:c})}),e.jsxs("p",{className:"text-sm text-center text-muted-foreground mt-4 sm:mt-6",children:["Don't have an account?"," ",e.jsx(O,{to:"/signup",className:"text-primary-strong font-semibold hover:underline transition-all",children:"Sign Up"})]})]})})]})})})]});return e.jsxs(e.Fragment,{children:[j,x]})};export{Ne as default};
