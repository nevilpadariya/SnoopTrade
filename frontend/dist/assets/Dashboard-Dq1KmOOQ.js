import{j as e,u as Oe,H as Be}from"./index-BHBSRF_I.js";import{r as i,R as Te,u as Ke}from"./vendor-router-sBGvKeAa.js";import{N as ze}from"./Navbar-oQx-Phe9.js";import{M as Ue}from"./MobileBottomNav-B0jwvfbg.js";import{c as B,b as D,C as K,d as Ge,e as He,a as W,B as $}from"./card-D00CZe4s.js";import{R as te,L as ke,C as De,X as Ae,Y as _e,T as se,a as ae,b as Q,A as We,P as Ve,c as Je,d as qe}from"./vendor-charts-DIWzVVbk.js";import{I as Xe,A as G}from"./apiEndpoints-CWnIra_r.js";import{S as Ye}from"./search-BUqzw1Su.js";import"./trending-up-DJhHAQ3_.js";import"./user-BfyReuvm.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=B("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=B("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=B("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=B("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=B("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]),Le=i.forwardRef(({className:o,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:D("w-full caption-bottom text-sm",o),...t})}));Le.displayName="Table";const Me=i.forwardRef(({className:o,...t},a)=>e.jsx("thead",{ref:a,className:D("[&_tr]:border-b",o),...t}));Me.displayName="TableHeader";const Pe=i.forwardRef(({className:o,...t},a)=>e.jsx("tbody",{ref:a,className:D("[&_tr:last-child]:border-0",o),...t}));Pe.displayName="TableBody";const st=i.forwardRef(({className:o,...t},a)=>e.jsx("tfoot",{ref:a,className:D("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",o),...t}));st.displayName="TableFooter";const H=i.forwardRef(({className:o,...t},a)=>e.jsx("tr",{ref:a,className:D("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",o),...t}));H.displayName="TableRow";const M=i.forwardRef(({className:o,...t},a)=>e.jsx("th",{ref:a,className:D("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",o),...t}));M.displayName="TableHead";const L=i.forwardRef(({className:o,...t},a)=>e.jsx("td",{ref:a,className:D("p-4 align-middle [&:has([role=checkbox])]:pr-0",o),...t}));L.displayName="TableCell";const at=i.forwardRef(({className:o,...t},a)=>e.jsx("caption",{ref:a,className:D("mt-4 text-sm text-muted-foreground",o),...t}));at.displayName="TableCaption";const fe=({tradeData:o,rowsPerPage:t,page:a,handleChangePage:l,handleChangeRowsPerPage:p})=>{const[s,y]=i.useState("date"),[h,f]=i.useState("desc"),c=r=>{const u=s===r&&h==="asc";y(r),f(u?"desc":"asc")},d=o.filter(r=>{const u=new Date(r.date),v=new Date;return!isNaN(u.getTime())&&u<=v&&r.date!==null&&r.date!==void 0}),x=r=>({P:"Purchase",S:"Sale",A:"Grant",D:"Sale to Loss",F:"Payment of Exercise",I:"Discretionary Transaction",M:"Exercise/Conversion"})[r]||r,A=r=>({P:"text-emerald-400",S:"text-red-400",A:"text-teal-400",D:"text-amber-400",F:"text-violet-400",I:"text-lime-400",M:"text-cyan-400",G:"text-green-400"})[r]||"text-slate-400",_=[...d].sort((r,u)=>{if(s==="date"){const v=new Date(r.date).getTime(),N=new Date(u.date).getTime();return h==="asc"?v-N:N-v}else{if(s==="shares")return h==="asc"?r.shares-u.shares:u.shares-r.shares;if(s==="price_per_share")return h==="asc"?r.price_per_share-u.price_per_share:u.price_per_share-r.price_per_share;if(s==="transaction_code"){const v=x(r.transaction_code),N=x(u.transaction_code);return h==="asc"?v.localeCompare(N):N.localeCompare(v)}else if(s==="total_value"){const v=r.shares*(r.price_per_share||0),N=u.shares*(u.price_per_share||0);return h==="asc"?v-N:N-v}}return 0}).slice(a*t,a*t+t),E=r=>{const u=new Date(r);return isNaN(u.getTime())?"Invalid Date":u.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},C=Math.ceil(d.length/t);return e.jsxs(K,{className:"w-full bg-card/80 backdrop-blur-sm border-border/50 shadow-lg",children:[e.jsxs(Ge,{className:"space-y-1 pb-4",children:[e.jsx(He,{className:"text-2xl font-bold text-card-foreground font-display",children:"Transaction History"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Detailed breakdown of all insider trading transactions"})]}),e.jsxs(W,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Le,{children:[e.jsx(Me,{children:e.jsxs(H,{className:"border-b border-border/30 hover:bg-transparent",children:[e.jsx(M,{className:"text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>c("date"),className:"flex items-center gap-2 hover:text-primary transition-colors",children:["Date",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(M,{className:"text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>c("transaction_code"),className:"flex items-center gap-2 hover:text-primary transition-colors",children:["Type",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(M,{className:"text-right text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>c("shares"),className:"flex items-center gap-2 ml-auto hover:text-primary transition-colors",children:["Shares",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(M,{className:"text-right text-card-foreground font-semibold hidden sm:table-cell",children:e.jsxs("button",{onClick:()=>c("price_per_share"),className:"flex items-center gap-2 ml-auto hover:text-primary transition-colors",children:["Price/Share",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(M,{className:"text-right text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>c("total_value"),className:"flex items-center gap-2 ml-auto hover:text-primary transition-colors",children:["Total Value",e.jsx(R,{className:"h-4 w-4"})]})})]})}),e.jsx(Pe,{children:_.length>0?_.map((r,u)=>e.jsxs(H,{className:"border-b border-border/20 hover:bg-primary/5 transition-colors",children:[e.jsx(L,{className:"font-medium text-card-foreground/90",children:E(r.date)}),e.jsx(L,{children:e.jsx("span",{className:`font-semibold ${A(r.transaction_code)}`,children:x(r.transaction_code)})}),e.jsx(L,{className:"text-right text-card-foreground/80 font-mono",children:r.shares?.toLocaleString()||"N/A"}),e.jsxs(L,{className:"text-right text-card-foreground/80 font-mono hidden sm:table-cell",children:["$",r.price_per_share?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})||"N/A"]}),e.jsxs(L,{className:"text-right font-semibold text-primary-strong font-mono",children:["$",(r.shares*(r.price_per_share||0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},u)):e.jsx(H,{children:e.jsx(L,{colSpan:5,className:"text-center text-muted-foreground py-12",children:"No transaction data available."})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-6 py-4 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Rows per page:"}),e.jsx("select",{value:t,onChange:r=>{const u={target:{value:r.target.value}};p(u)},className:"bg-card text-card-foreground border border-border/50 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-primary",children:[5,10,25,50].map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",a+1," of ",C||1," (",d.length," total)"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{variant:"ghost",size:"icon",onClick:r=>l(r,0),disabled:a===0,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsx($,{variant:"ghost",size:"icon",onClick:r=>l(r,a-1),disabled:a===0,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx($,{variant:"ghost",size:"icon",onClick:r=>l(r,a+1),disabled:a>=C-1,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx($,{variant:"ghost",size:"icon",onClick:r=>l(r,C-1),disabled:a>=C-1,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(tt,{className:"h-4 w-4"})})]})]})]})]})]})},O=Te.memo(({title:o,data:t,dataKey:a,lineColor:l,isLogScale:p})=>{const[s,y]=i.useState(window.matchMedia("(max-width: 767px)").matches);return i.useEffect(()=>{const h=window.matchMedia("(max-width: 767px)"),f=c=>y(c.matches);return h.addEventListener("change",f),()=>h.removeEventListener("change",f)},[]),e.jsx(K,{className:"p-3 md:p-6 bg-card border-border shadow-md",children:e.jsxs(W,{className:"p-0",children:[e.jsx("h3",{className:"text-base md:text-2xl font-semibold mb-3 md:mb-6 text-card-foreground font-display",children:o}),e.jsx(te,{width:"100%",height:s?260:400,children:e.jsxs(ke,{data:t,children:[e.jsx(De,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(Ae,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:s?10:12},tickFormatter:s?h=>{const f=h.split(" ");return f.length>=2?`${f[0].substring(0,3)} ${f[f.length-1].substring(2)}`:h}:void 0}),e.jsx(_e,{scale:p?"log":"auto",domain:p?["auto","auto"]:void 0,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:s?10:12},width:s?40:60}),e.jsx(se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",color:"hsl(var(--card-foreground))"},itemStyle:{color:"hsl(var(--card-foreground))"},labelStyle:{color:"hsl(var(--card-foreground))"}}),e.jsx(ae,{wrapperStyle:{color:"hsl(var(--card-foreground))"}}),e.jsx(Q,{type:"monotone",dataKey:a,stroke:l,strokeWidth:2,dot:!1})]})})]})})});O.displayName="ChartContainer";const ee=Te.memo(({title:o,data:t,dataKey:a,lineColor:l,isLogScale:p,additionalLines:s=[],areaDataKeyLower:y,areaDataKeyUpper:h})=>{const[f,c]=i.useState(window.matchMedia("(max-width: 767px)").matches);return i.useEffect(()=>{const d=window.matchMedia("(max-width: 767px)"),x=A=>c(A.matches);return d.addEventListener("change",x),()=>d.removeEventListener("change",x)},[]),e.jsx(K,{className:"p-3 md:p-6 bg-card border-border shadow-md",children:e.jsxs(W,{className:"p-0",children:[e.jsx("h3",{className:"text-base md:text-2xl font-semibold mb-3 md:mb-6 text-card-foreground font-display",children:o}),e.jsx(te,{width:"100%",height:f?260:400,children:e.jsxs(ke,{data:t,children:[e.jsx(De,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(Ae,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:f?10:12},tickFormatter:f?d=>{const x=d.split(" ");return x.length>=2?`${x[0].substring(0,3)} ${x[x.length-1].substring(2)}`:d}:void 0}),e.jsx(_e,{scale:p?"log":"auto",domain:p?["auto","auto"]:void 0,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:f?10:12},width:f?40:60}),e.jsx(se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",color:"hsl(var(--card-foreground))"},itemStyle:{color:"hsl(var(--card-foreground))"},labelStyle:{color:"hsl(var(--card-foreground))"}}),e.jsx(ae,{wrapperStyle:{color:"hsl(var(--card-foreground))"}}),y&&h&&e.jsx(We,{type:"monotone",dataKey:y,stackId:"1",stroke:"none",fill:l,fillOpacity:.3}),e.jsx(Q,{type:"monotone",dataKey:a,stroke:l,strokeWidth:3,dot:!1}),s.map((d,x)=>e.jsx(Q,{type:"monotone",dataKey:d.dataKey,stroke:d.lineColor,strokeWidth:2,strokeDasharray:"5 5",dot:!1},x))]})})]})})});ee.displayName="ForecastChartContainer";const rt=({searchTerm:o,onSearchChange:t})=>e.jsxs("div",{className:"relative w-full max-w-2xl mx-auto",children:[e.jsx(Ye,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(Xe,{type:"text",placeholder:"Search for a company...",value:o,onChange:t,className:"pl-12 h-14 text-lg bg-card border-border focus:ring-2 focus:ring-primary"})]});function ot(o){const t="pk_ch_0yAQ0RdqVUu60Kkk4bg";return o?`https://img.logo.dev/ticker/${encodeURIComponent(o.toUpperCase())}?token=${encodeURIComponent(t)}`:null}const Ee=({ticker:o,size:t=32,className:a=""})=>{const[l,p]=i.useState(!1),s=ot(o),y=!s||l,h=o?o[0].toUpperCase():"?",f={width:t,height:t};return y?e.jsx("span",{className:`inline-flex items-center justify-center rounded-full bg-muted text-muted-foreground font-semibold shrink-0 ${a}`,style:f,"aria-hidden":!0,children:h}):e.jsx("img",{src:s,alt:"",className:`rounded-full object-contain shrink-0 ${a}`,style:f,onError:()=>p(!0)})},nt=({companies:o,companyNames:t={},onSelectCompany:a})=>e.jsx(K,{className:"w-full max-w-2xl mx-auto bg-card border-border shadow-lg",children:e.jsx("ul",{className:"divide-y divide-border",children:o.map(l=>{const p=t[l]?`${l} (${t[l]})`:l;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>a(l),className:"w-full px-6 py-4 flex items-center gap-3 text-left text-card-foreground hover:bg-muted transition-colors duration-150 cursor-pointer text-lg font-medium",children:[e.jsx(Ee,{ticker:l,size:28}),p]})},l)})})}),ge={G:"Gift",S:"Sale",M:"Exercise/Conversion",F:"Payment of Exercise",A:"Grant/Award",P:"Purchase",D:"Sale to Issuer",I:"Discretionary"},be=({title:o,data:t,dataKey:a,nameKey:l,colors:p})=>{const[s,y]=i.useState(window.matchMedia("(max-width: 767px)").matches);i.useEffect(()=>{const c=window.matchMedia("(max-width: 767px)"),d=x=>y(x.matches);return c.addEventListener("change",d),()=>c.removeEventListener("change",d)},[]);const h=({cx:c,cy:d,midAngle:x,innerRadius:A,outerRadius:P,value:_,index:E})=>{const C=Math.PI/180,r=P*1.2,u=c+r*Math.cos(-x*C),v=d+r*Math.sin(-x*C);return e.jsx("text",{x:u,y:v,fill:"hsl(var(--card-foreground))",textAnchor:u>c?"start":"end",dominantBaseline:"central",className:"text-sm font-medium",children:_.toLocaleString()})},f=c=>ge[c]||c;return e.jsx(K,{className:"p-3 md:p-6 bg-card/80 backdrop-blur-sm border-border/50 shadow-lg hover:shadow-xl transition-shadow duration-300",children:e.jsxs(W,{className:"p-0",children:[e.jsx("h3",{className:"text-sm md:text-xl font-semibold mb-2 md:mb-4 text-card-foreground font-display",children:o}),e.jsx(te,{width:"100%",height:s?260:350,children:e.jsxs(Ve,{children:[e.jsx("defs",{children:p.map((c,d)=>e.jsxs("linearGradient",{id:`gradient-${d}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:c,stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:c,stopOpacity:.7})]},`gradient-${d}`))}),e.jsx(Je,{data:t,dataKey:a,nameKey:l,cx:"50%",cy:"50%",innerRadius:s?40:60,outerRadius:s?70:100,paddingAngle:3,label:s?!1:h,labelLine:s?!1:{stroke:"hsl(var(--muted-foreground))",strokeWidth:1},animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:t.map((c,d)=>e.jsx(qe,{fill:`url(#gradient-${d%p.length})`,stroke:"hsl(var(--card))",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"}},`cell-${d}`))}),e.jsx(se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"12px",color:"hsl(var(--card-foreground))",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",padding:"12px 16px"},itemStyle:{color:"hsl(var(--card-foreground))"},formatter:(c,d)=>[c.toLocaleString(),ge[d]||d],labelStyle:{color:"hsl(var(--muted-foreground))"}}),e.jsx(ae,{verticalAlign:"bottom",height:36,formatter:f,wrapperStyle:{color:"hsl(var(--card-foreground))",paddingTop:"20px"},iconType:"circle",iconSize:10})]})})]})})},ye=["hsl(142, 70%, 45%)","hsl(160, 55%, 40%)","hsl(142, 45%, 35%)","hsl(175, 50%, 38%)","hsl(130, 50%, 45%)","hsl(155, 60%, 32%)","hsl(140, 40%, 55%)"],je=({tradeData:o})=>{const t=o.reduce((l,p)=>{const s=l.find(y=>y.name===p.transaction_code);return s?s.value+=1:l.push({name:p.transaction_code,value:1}),l},[]),a=o.reduce((l,p)=>{const s=l.find(y=>y.name===p.transaction_code);return s?s.value+=p.shares:l.push({name:p.transaction_code,value:p.shares}),l},[]);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8",children:[e.jsx(be,{title:"Transaction Types Distribution",data:t,dataKey:"value",nameKey:"name",colors:ye}),e.jsx(be,{title:"Shares Distribution",data:a,dataKey:"value",nameKey:"name",colors:ye})]})},ve=async(o,t)=>{const a=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error(`Error ${a.status}: ${a.statusText}`);return a.json()},Z={"1M":"1m","3M":"3m","6M":"6m","1Y":"1y"},Ne=["AAPL","META","NVDA","GOOGL","MSFT","AMZN","TSLA","NFLX","JPM","JNJ","V","UNH","HD","DIS","BAC","XOM","PG","MA","PEP","WMT"],F={AAPL:"Apple Inc.",META:"Meta Platforms",NVDA:"NVIDIA",GOOGL:"Alphabet (Google)",MSFT:"Microsoft",AMZN:"Amazon",TSLA:"Tesla",NFLX:"Netflix",JPM:"JPMorgan Chase",JNJ:"Johnson & Johnson",V:"Visa",UNH:"UnitedHealth",HD:"Home Depot",DIS:"Walt Disney",BAC:"Bank of America",XOM:"Exxon Mobil",PG:"Procter & Gamble",MA:"Mastercard",PEP:"PepsiCo",WMT:"Walmart"},T={price:"hsl(var(--primary-strong))",volume:"hsl(var(--accent))",forecast:"#ef4444",trend:"#f97316",seasonal:"#3b82f6"},it=12e4,we=new Map,Se=new Map;function Ce(o,t){const a=o.get(t);return a&&Date.now()-a.ts<it?a.data:(o.delete(t),null)}function lt(){const o=new Date().getHours();return o<12?"Good morning":o<17?"Good afternoon":"Good evening"}function ct(o){return o?o.split(" ").slice(0,2).map(t=>t[0]?.toUpperCase()||"").join(""):"?"}const jt=o=>{const[t,a]=i.useState(""),[l,p]=i.useState(!1),[s,y]=i.useState(null),[h,f]=i.useState(Z["1Y"]),[c,d]=i.useState([]),[x,A]=i.useState([]),[P,_]=i.useState(0),[E,C]=i.useState(10),[r,u]=i.useState([]),[v]=i.useState(!1),[N]=i.useState(!1),[z,re]=i.useState(!1),[oe,ne]=i.useState(!1),[U,V]=i.useState(""),ie=Ke(),{token:w,setToken:le}=Oe(),[ce,de]=i.useState("");i.useRef(null),i.useEffect(()=>{w&&fetch(G.getUserDetails,{headers:{Authorization:`Bearer ${w}`}}).then(n=>n.ok?n.json():null).then(n=>{n?.name?de(n.name):n?.first_name&&de(n.first_name)}).catch(()=>{})},[w]);const I=i.useMemo(()=>{const n=t.toLowerCase().trim();return n?Ne.filter(m=>{const g=(F[m]??"").toLowerCase();return m.toLowerCase().includes(n)||g.includes(n)}):Ne},[t]);i.useEffect(()=>{p(t.length>0)},[t]);const me=i.useCallback(n=>{y(n),a(""),p(!1),ne(!1),V("")},[]),he=i.useCallback(n=>{f(n)},[]),xe=i.useCallback(async()=>{if(!s||!w)return;const n=`${s}:${h}`,m=Ce(we,n);if(m){d(m);return}try{const g=G.getStocks(s,h),S=(await ve(g,w)).filter(j=>j.date).map(j=>{const b=new Date(j.date);return{date:b.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),dateISO:b.toISOString().split("T")[0],open:j.open??0,close:j.close??0,high:j.high??0,low:j.low??0}}).sort((j,b)=>new Date(j.dateISO).getTime()-new Date(b.dateISO).getTime());we.set(n,{data:S,ts:Date.now()}),d(S)}catch(g){console.error("Error fetching stock data:",g),g.message.includes("401")&&(le(null),ie("/login"))}},[s,h,w,le,ie]),ue=i.useCallback(async n=>{if(!n||n.length===0){console.error("No formatted data available for forecasting");return}re(!0),V("");try{const m=n.map(S=>({date:S.dateISO??new Date(S.date).toISOString().split("T")[0],open:S.open,high:S.high,low:S.low,close:S.close})),g=await fetch(G.fetchFutureData,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify(m)});if(!g.ok){const j=(await g.json().catch(()=>({}))).detail??`Error from forecast API: ${g.statusText}`;throw new Error(typeof j=="string"?j:JSON.stringify(j))}const X=await g.json();u(X),ne(!0)}catch(m){console.error("Error during forecasting:",m),V(m?.message??"Failed to load forecast. Please try again.")}finally{re(!1)}},[w]),pe=i.useCallback(async()=>{if(!s||!w)return;const n=`${s}:${h}`,m=Ce(Se,n);if(m){A(m);return}try{const g=G.getTransactions(s,h),j=(await ve(g,w)).filter(b=>{const Y=new Date(b.transaction_date);return!isNaN(Y.getTime())}).map(b=>({filing_date:b.filing_date,date:b.transaction_date,formatted_date:new Date(b.transaction_date).toLocaleDateString("en-US"),shares:Number(b.shares)||0,transaction_code:b.transaction_code,price_per_share:b.price_per_share,ownership_type:b.ownership_type,issuer_name:b.issuer_name,security_title:b.security_title})).sort((b,Y)=>new Date(Y.date).getTime()-new Date(b.date).getTime());Se.set(n,{data:j,ts:Date.now()}),A(j)}catch(g){console.error("Error fetching insider trade data:",g)}},[s,h,w]);i.useEffect(()=>{w&&s&&(xe(),pe())},[xe,pe,w,s]);const k=c.length?c[c.length-1]:null,J=x.filter(n=>n.transaction_code==="P").length,q=x.filter(n=>n.transaction_code==="S").length,Ie=J>q?"mildly bullish":q>J?"cautious":"neutral",Re=ct(ce),Fe=e.jsxs("div",{className:"md:hidden has-bottom-nav",style:{backgroundColor:"#0E1410",minHeight:"100vh"},children:[e.jsxs("div",{style:{padding:"16px 20px",display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,paddingTop:8,paddingBottom:8},children:[e.jsx("div",{className:"mobile-avatar",children:Re}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"#A7B7AC",fontSize:12},children:lt()}),e.jsx("p",{style:{color:"#EAF5EC",fontSize:22,fontWeight:700},children:ce||"Trader"})]})]}),e.jsx("input",{className:"mobile-input",placeholder:"Search ticker or company...",value:t,onChange:n=>a(n.target.value),style:{textTransform:"uppercase"}}),l&&I.length>0&&e.jsx("div",{className:"mobile-card",style:{padding:8,maxHeight:200,overflowY:"auto"},children:I.map(n=>e.jsxs("button",{onClick:()=>me(n),style:{display:"block",width:"100%",textAlign:"left",padding:"10px 12px",color:"#EAF5EC",fontSize:14,background:"transparent",border:"none",cursor:"pointer",borderRadius:8},onMouseOver:m=>m.currentTarget.style.backgroundColor="#253129",onMouseOut:m=>m.currentTarget.style.backgroundColor="transparent",children:[e.jsx("span",{style:{fontWeight:700},children:n}),e.jsx("span",{style:{color:"#A7B7AC",marginLeft:8},children:F[n]})]},n))}),s&&e.jsxs("div",{className:"mobile-chip",children:[e.jsx("div",{className:"dot"}),e.jsx("span",{className:"ticker",children:s}),e.jsx("span",{className:"name",children:F[s]||s})]}),s&&e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:Object.entries(Z).map(([n,m])=>e.jsx("button",{className:`mobile-filter-chip ${h===m?"active":""}`,onClick:()=>he(m),children:n},m))}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mobile-card mobile-card-shadow",children:e.jsx(O,{title:`Stock Price (${h.toUpperCase()})`,data:c,dataKey:"open",lineColor:T.price,isLogScale:N})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"Open"}),e.jsx("div",{className:"value",children:k?`$${Number(k.open).toFixed(2)}`:"--"})]}),e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"Close"}),e.jsx("div",{className:"value",children:k?`$${Number(k.close).toFixed(2)}`:"--"})]}),e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"High"}),e.jsx("div",{className:"value",children:k?`$${Number(k.high).toFixed(2)}`:"--"})]}),e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"Low"}),e.jsx("div",{className:"value",children:k?`$${Number(k.low).toFixed(2)}`:"--"})]})]}),e.jsxs("div",{className:"mobile-snapshot",children:[e.jsx("div",{className:"title",children:"Insider Snapshot"}),e.jsxs("div",{style:{display:"flex",gap:24},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:4,backgroundColor:"#68D08E"}}),e.jsxs("span",{style:{color:"#A7B7AC",fontSize:15},children:["Purchases: ",J]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:4,backgroundColor:"#E56A6A"}}),e.jsxs("span",{style:{color:"#A7B7AC",fontSize:15},children:["Sales: ",q]})]})]}),e.jsxs("p",{style:{color:"#64C9A8",fontSize:15,fontWeight:600,marginTop:12},children:["Net signal: ",Ie]})]}),e.jsx("button",{className:"mobile-btn-primary",onClick:()=>ue(c),disabled:z,children:z?"Predicting...":"Predict Future Trends"}),U&&e.jsx("p",{style:{color:"#E56A6A",fontSize:12,textAlign:"center"},children:U}),oe&&e.jsx("div",{id:"forecast",className:"mobile-card mobile-card-shadow",children:e.jsx(ee,{title:"Predicted Stock Price Trends",data:r,dataKey:"open",lineColor:T.forecast,isLogScale:N,additionalLines:[{dataKey:"trend",lineColor:T.trend,title:"Trend"},{dataKey:"seasonal",lineColor:T.seasonal,title:"Seasonal"}],areaDataKeyLower:"yhat_lower",areaDataKeyUpper:"yhat_upper"})}),e.jsx("div",{className:"mobile-card mobile-card-shadow",children:e.jsx(O,{title:"Volume of Shares Traded",data:x,dataKey:"shares",lineColor:T.volume,isLogScale:v})}),e.jsx("div",{className:"mobile-card mobile-card-shadow",children:e.jsx(je,{tradeData:x})}),e.jsxs("div",{id:"transactions",children:[e.jsx("h3",{style:{color:"#EAF5EC",fontSize:22,fontWeight:700,textAlign:"center",marginBottom:16},children:"Transaction Details"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsx(fe,{tradeData:x,rowsPerPage:E,page:P,handleChangePage:(n,m)=>_(m),handleChangeRowsPerPage:n=>C(parseInt(n.target.value,10))})})]})]})]}),e.jsx(Ue,{})]}),$e=e.jsxs("div",{className:"min-h-screen bg-background text-foreground hidden md:block",children:[e.jsx(Be,{children:e.jsx("title",{children:"Dashboard | SnoopTrade"})}),e.jsx(ze,{}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 pt-24 sm:pt-28 md:pt-32 pb-12 sm:pb-16",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-center mb-4 sm:mb-6 font-display text-foreground",children:["Insider Trading ",e.jsx("span",{className:"text-primary-strong",children:"Dashboard"})]}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl text-center text-muted-foreground mb-10 sm:mb-12 md:mb-16 max-w-3xl mx-auto px-4",children:"Analyze market trends and insider trading activities with real-time data and insights."}),e.jsxs("div",{className:"flex flex-col items-center mt-6 sm:mt-8 space-y-4",children:[e.jsx(rt,{searchTerm:t,onSearchChange:n=>a(n.target.value)}),l&&I.length>0&&e.jsx(nt,{companies:I,companyNames:F,onSelectCompany:me}),l&&I.length===0&&e.jsx("p",{className:"text-muted-foreground mt-4 text-sm sm:text-base",children:"No companies found."}),s&&e.jsx("div",{className:"flex justify-center mt-6 sm:mt-8 w-full px-2",children:e.jsx("div",{className:"time-range-row inline-flex rounded-xl border border-border bg-muted/30 p-1 shadow-inner",role:"group","aria-label":"Stock data range",children:Object.entries(Z).map(([n,m])=>{const g=h===m;return e.jsx("button",{type:"button",onClick:()=>he(m),className:`
                        relative px-4 py-2.5 text-sm font-medium rounded-lg
                        transition-all duration-200 ease-out
                        min-w-[4rem] whitespace-nowrap
                        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background
                        ${g?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                      `,"aria-pressed":g,children:n},m)})})})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-center mt-10 sm:mt-12 mb-6 sm:mb-8 font-display text-foreground px-4 flex items-center justify-center gap-3 flex-wrap",children:[e.jsx(Ee,{ticker:s,size:40}),e.jsxs("span",{children:["Data for ",s," (",F[s]??s,")"]})]}),e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(O,{title:"Stock Price Trends",data:c,dataKey:"open",lineColor:T.price,isLogScale:N})}),e.jsx("div",{className:"flex justify-center mb-6 sm:mb-8 px-4",children:e.jsx($,{onClick:()=>ue(c),disabled:z,className:"w-full sm:w-auto px-6 sm:px-8 h-12 sm:h-auto sm:py-3 text-base sm:text-lg font-semibold",children:z?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}),e.jsx("span",{children:"Predicting..."})]}):"Predict Future Trends"})}),U&&e.jsx("div",{className:"mb-6 px-4 py-3 rounded-md bg-destructive/10 text-destructive-foreground text-sm text-center",role:"alert",children:U}),oe&&e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(ee,{title:"Predicted Stock Price Trends",data:r,dataKey:"open",lineColor:T.forecast,isLogScale:N,additionalLines:[{dataKey:"trend",lineColor:T.trend,title:"Trend"},{dataKey:"seasonal",lineColor:T.seasonal,title:"Seasonal"}],areaDataKeyLower:"yhat_lower",areaDataKeyUpper:"yhat_upper"})}),e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(O,{title:"Volume of Shares Traded",data:x,dataKey:"shares",lineColor:T.volume,isLogScale:v})}),e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(je,{tradeData:x})}),e.jsxs("div",{className:"mt-10 sm:mt-12",children:[e.jsx("h3",{className:"text-2xl sm:text-3xl font-semibold text-center mb-4 sm:mb-6 font-display text-foreground px-4",children:"Transaction Details"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(fe,{tradeData:x,rowsPerPage:E,page:P,handleChangePage:(n,m)=>_(m),handleChangeRowsPerPage:n=>C(parseInt(n.target.value,10))})})]})]})]})]});return e.jsxs(e.Fragment,{children:[Fe,$e]})};export{jt as default};
