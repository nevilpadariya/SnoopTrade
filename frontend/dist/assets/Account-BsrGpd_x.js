import{u as Z,j as e,H as O}from"./index-BdWBpXNs.js";import{u as ee,r}from"./vendor-router-sBGvKeAa.js";import{N as E}from"./Navbar-D2UotZHs.js";import{M as se}from"./MobileBottomNav-CYW5ze22.js";import{c as N,C as G,a as W,B as te}from"./card-CAAq5ZaP.js";import{I as g,A as H}from"./apiEndpoints-Cjc9S1sZ.js";import{E as x,a as p,L as u}from"./label-D2Py_7J7.js";import"./trending-up-DXh838HL.js";import"./user-AsS-Y0Xm.js";import"./vendor-charts-P8qmgMGQ.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=N("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=N("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=N("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=N("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function re(h){return h?h.split(" ").slice(0,2).map(v=>v[0]?.toUpperCase()||"").join(""):"?"}const he=()=>{const{token:h,setToken:v}=Z(),q=ee(),[t,B]=r.useState(null),[J,F]=r.useState(!0),[I,C]=r.useState(""),[f,k]=r.useState(""),[l,P]=r.useState(""),[j,A]=r.useState(""),[i,D]=r.useState(!1),[d,L]=r.useState(!1),[c,T]=r.useState(!1),[y,_]=r.useState(!1),[b,U]=r.useState(""),[w,n]=r.useState("");r.useEffect(()=>{(async()=>{try{const m=h;if(!m){C("Not authenticated. Please log in."),F(!1);return}const o=await fetch(H.getUserDetails,{headers:{Authorization:`Bearer ${m}`}});if(o.ok){const S=await o.json();B(S)}else{const S=await o.json();C(S.detail||"Failed to fetch user data.")}}catch{C("Something went wrong. Please try again.")}finally{F(!1)}})()},[]);const s=t?.login_type==="google",M=async()=>{if(n(""),U(""),!l||!j){n("Please fill in all password fields.");return}if(l.length<6){n("Password must be at least 6 characters long.");return}if(l!==j){n("Passwords do not match.");return}if(!s&&!f){n("Please enter your current password.");return}_(!0);try{const a=h,m=await fetch(H.updateUserProfile,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({password:l,current_password:f})});if(m.ok)U(s?"Password created successfully! You can now log in with email and password.":"Password updated successfully!"),k(""),P(""),A(""),s&&B(o=>o?{...o,login_type:"both"}:null);else{const o=await m.json();n(o.detail||"Failed to update password.")}}catch{n("Something went wrong. Please try again.")}finally{_(!1)}},V=()=>{v(null),q("/login")};if(J)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(E,{})}),e.jsx("div",{className:"flex items-center justify-center pt-24 sm:pt-32 md:pt-40",children:e.jsx($,{className:"h-8 w-8 animate-spin text-primary"})})]});if(I)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(E,{})}),e.jsx("div",{className:"flex items-center justify-center pt-24 sm:pt-32 md:pt-40 px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(z,{className:"h-10 w-10 sm:h-12 sm:w-12 text-destructive mx-auto mb-4"}),e.jsx("p",{className:"text-destructive text-sm sm:text-base",children:I})]})})]});const Y=re(t?.name),K=t?.login_type==="google"?"Google":t?.login_type==="both"?"Google + Email":"Email",Q=e.jsxs("div",{className:"md:hidden has-bottom-nav",style:{backgroundColor:"#0E1410",minHeight:"100vh"},children:[e.jsx(O,{children:e.jsx("title",{children:"Account Settings | SnoopTrade"})}),e.jsxs("div",{style:{padding:"24px 20px",display:"flex",flexDirection:"column",gap:16},children:[e.jsx("h1",{style:{color:"#EAF5EC",fontSize:28,fontWeight:700},children:"Account"}),e.jsxs("div",{className:"mobile-card mobile-card-shadow",style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("div",{className:"mobile-avatar mobile-avatar-lg",children:Y}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"#EAF5EC",fontSize:20,fontWeight:700},children:t?.name||""}),e.jsx("p",{style:{color:"#A7B7AC",fontSize:13,marginTop:2},children:t?.email||""}),e.jsx("span",{style:{display:"inline-block",marginTop:8,padding:"4px 12px",borderRadius:999,fontSize:11,fontWeight:700,backgroundColor:t?.login_type==="google"?"rgba(59,130,246,0.2)":"rgba(183,227,137,0.2)",color:t?.login_type==="google"?"#60A5FA":"#B7E389"},children:K})]})]}),e.jsxs("div",{className:"mobile-card mobile-card-shadow",children:[e.jsx("h2",{style:{color:"#EAF5EC",fontSize:18,fontWeight:700,marginBottom:16},children:"Account Information"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#A7B7AC",fontSize:12,display:"block",marginBottom:6},children:"Email"}),e.jsx("div",{className:"mobile-input",style:{display:"flex",alignItems:"center",opacity:.7},children:t?.email||""})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#A7B7AC",fontSize:12,display:"block",marginBottom:6},children:"Name"}),e.jsx("div",{className:"mobile-input",style:{display:"flex",alignItems:"center",opacity:.7},children:t?.name||""})]})]})]}),e.jsxs("div",{className:"mobile-card mobile-card-shadow",children:[e.jsx("h2",{style:{color:"#EAF5EC",fontSize:18,fontWeight:700,marginBottom:4},children:s?"Create Password":"Change Password"}),s&&e.jsx("p",{style:{color:"#A7B7AC",fontSize:13,marginBottom:16},children:"Create a password to also log in with email."}),b&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:12,borderRadius:12,backgroundColor:"rgba(104,208,142,0.2)",color:"#68D08E",marginBottom:12,fontSize:13},children:[e.jsx(R,{size:16}),e.jsx("span",{children:b})]}),w&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:12,borderRadius:12,backgroundColor:"rgba(229,106,106,0.2)",color:"#E56A6A",marginBottom:12,fontSize:13},children:[e.jsx(z,{size:16}),e.jsx("span",{children:w})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[!s&&e.jsxs("div",{children:[e.jsx("label",{style:{color:"#A7B7AC",fontSize:12,display:"block",marginBottom:6},children:"Current Password"}),e.jsxs("div",{className:"mobile-input",style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{type:i?"text":"password",placeholder:"Current password",value:f,onChange:a=>k(a.target.value),style:{flex:1,background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15}}),e.jsx("button",{onClick:()=>D(!i),style:{background:"none",border:"none",cursor:"pointer",color:"#A7B7AC"},children:i?e.jsx(x,{size:18}):e.jsx(p,{size:18})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#A7B7AC",fontSize:12,display:"block",marginBottom:6},children:s?"Password":"New Password"}),e.jsxs("div",{className:"mobile-input",style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{type:d?"text":"password",placeholder:s?"Enter password":"New password",value:l,onChange:a=>P(a.target.value),style:{flex:1,background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15}}),e.jsx("button",{onClick:()=>L(!d),style:{background:"none",border:"none",cursor:"pointer",color:"#A7B7AC"},children:d?e.jsx(x,{size:18}):e.jsx(p,{size:18})})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#A7B7AC",fontSize:12,display:"block",marginBottom:6},children:"Confirm Password"}),e.jsxs("div",{className:"mobile-input",style:{display:"flex",alignItems:"center"},children:[e.jsx("input",{type:c?"text":"password",placeholder:"Confirm password",value:j,onChange:a=>A(a.target.value),style:{flex:1,background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15}}),e.jsx("button",{onClick:()=>T(!c),style:{background:"none",border:"none",cursor:"pointer",color:"#A7B7AC"},children:c?e.jsx(x,{size:18}):e.jsx(p,{size:18})})]})]}),e.jsx("button",{className:"mobile-btn-primary",onClick:M,disabled:y,style:{marginTop:8},children:y?s?"Creating...":"Updating...":s?"Create Password":"Change Password"})]})]}),e.jsx("button",{className:"mobile-btn-danger",onClick:V,style:{marginTop:8},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[e.jsx(ae,{size:18})," Logout"]})})]}),e.jsx(se,{})]}),X=e.jsxs("div",{className:"min-h-screen bg-background hidden md:block",children:[e.jsx(O,{children:e.jsx("title",{children:"Account Settings | SnoopTrade"})}),e.jsx(E,{}),e.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 pt-16 sm:pt-20 pb-12 sm:pb-16",children:e.jsxs("div",{className:"max-w-3xl mx-auto pt-6 sm:pt-8 md:pt-12",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-extrabold text-foreground mb-2 font-display",children:["Account ",e.jsx("span",{className:"text-primary-strong",children:"Settings"})]}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl text-muted-foreground mb-8 sm:mb-10 md:mb-12",children:"Manage your account information and security settings."}),e.jsx(G,{className:"mb-6 sm:mb-8 bg-card border-border",children:e.jsxs(W,{className:"p-4 sm:p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-card-foreground mb-4 sm:mb-6 font-display",children:"Account Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-card-foreground",children:"Email Address"}),e.jsx(g,{type:"email",value:t?.email||"",disabled:!0,className:"h-11 bg-muted/50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Email cannot be changed."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-card-foreground",children:"Name"}),e.jsx(g,{type:"text",value:t?.name||"",disabled:!0,className:"h-11 bg-muted/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-card-foreground",children:"Login Method"}),e.jsxs("div",{className:"flex items-center gap-2",children:[t?.login_type==="google"&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-500/20 text-blue-400",children:"Google Only"}),t?.login_type==="normal"&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary/20 text-primary",children:"Email & Password"}),t?.login_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-500/20 text-blue-400",children:"Google"}),e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary/20 text-primary",children:"Email & Password"})]})]})]})]})]})}),e.jsx(G,{className:"bg-card border-border",children:e.jsxs(W,{className:"p-4 sm:p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-semibold text-card-foreground mb-2 font-display",children:s?"Create Password":"Change Password"}),s&&e.jsx("p",{className:"text-muted-foreground mb-6",children:"Create a password to enable login with email and password in addition to Google."}),b&&e.jsxs("div",{className:"flex items-center gap-2 p-4 mb-6 rounded-lg bg-green-500/20 text-green-400",children:[e.jsx(R,{className:"h-5 w-5"}),e.jsx("span",{children:b})]}),w&&e.jsxs("div",{className:"flex items-center gap-2 p-4 mb-6 rounded-lg bg-destructive/20 text-destructive-foreground",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:w})]}),e.jsxs("div",{className:"space-y-4",children:[!s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"currentPassword",className:"text-card-foreground",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"currentPassword",type:i?"text":"password",placeholder:"Enter current password",value:f,onChange:a=>k(a.target.value),className:"h-11 pr-10"}),e.jsx("button",{type:"button",onClick:()=>D(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:i?e.jsx(x,{size:20}):e.jsx(p,{size:20})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"newPassword",className:"text-card-foreground",children:s?"Password":"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"newPassword",type:d?"text":"password",placeholder:s?"Enter password":"Enter new password",value:l,onChange:a=>P(a.target.value),className:"h-11 pr-10"}),e.jsx("button",{type:"button",onClick:()=>L(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:d?e.jsx(x,{size:20}):e.jsx(p,{size:20})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"confirmPassword",className:"text-card-foreground",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"confirmPassword",type:c?"text":"password",placeholder:"Confirm password",value:j,onChange:a=>A(a.target.value),className:"h-11 pr-10"}),e.jsx("button",{type:"button",onClick:()=>T(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:c?e.jsx(x,{size:20}):e.jsx(p,{size:20})})]})]}),e.jsx(te,{onClick:M,className:"px-8",disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Creating...":"Updating..."]}):s?"Create Password":"Change Password"})]})]})})]})})]});return e.jsxs(e.Fragment,{children:[Q,X]})};export{he as default};
