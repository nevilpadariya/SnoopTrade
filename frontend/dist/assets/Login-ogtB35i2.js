import{j as e,u as J,H as P}from"./index-BdWBpXNs.js";import{r as i,R as $,u as V,N as z,L as D}from"./vendor-router-sBGvKeAa.js";import{H as Y}from"./Header-BMxedqID.js";import{T as Q}from"./trending-up-DXh838HL.js";import{L as X}from"./lock-CbR1YUqS.js";import{C as Z}from"./chart-line-Ck-nAvlJ.js";import{B as ee,C as te}from"./card-CAAq5ZaP.js";import{I as O,A as F}from"./apiEndpoints-Cjc9S1sZ.js";import{L as W,E as oe,a as re}from"./label-D2Py_7J7.js";import"./vendor-charts-P8qmgMGQ.js";function ne(o={}){const{nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n}=o,[c,l]=i.useState(!1),u=i.useRef(r);u.current=r;const m=i.useRef(n);return m.current=n,i.useEffect(()=>{const s=document.createElement("script");return s.src="https://accounts.google.com/gsi/client",s.async=!0,s.defer=!0,s.nonce=t,s.onload=()=>{var d;l(!0),(d=u.current)===null||d===void 0||d.call(u)},s.onerror=()=>{var d;l(!1),(d=m.current)===null||d===void 0||d.call(m)},document.body.appendChild(s),()=>{document.body.removeChild(s)}},[t]),c}const K=i.createContext(null);function U({clientId:o,nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n,children:c}){const l=ne({nonce:t,onScriptLoadSuccess:r,onScriptLoadError:n}),u=i.useMemo(()=>({clientId:o,scriptLoadedSuccessfully:l}),[o,l]);return $.createElement(K.Provider,{value:u},c)}function se(){const o=i.useContext(K);if(!o)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return o}function ie(o){var t;return(t=o?.clientId)!==null&&t!==void 0?t:o?.client_id}const ae={large:40,medium:32,small:20};function le({onSuccess:o,onError:t,useOneTap:r,promptMomentNotification:n,type:c="standard",theme:l="outline",size:u="large",text:m,shape:s,logo_alignment:d,width:b,locale:x,click_listener:g,containerProps:a,...f}){const p=i.useRef(null),{clientId:h,scriptLoadedSuccessfully:w}=se(),R=i.useRef(o);R.current=o;const E=i.useRef(t);E.current=t;const G=i.useRef(n);return G.current=n,i.useEffect(()=>{var N,k,L,C,I,_,A,T,B;if(w)return(L=(k=(N=window?.google)===null||N===void 0?void 0:N.accounts)===null||k===void 0?void 0:k.id)===null||L===void 0||L.initialize({client_id:h,callback:v=>{var y;if(!v?.credential)return(y=E.current)===null||y===void 0?void 0:y.call(E);const{credential:j,select_by:M}=v;R.current({credential:j,clientId:ie(v),select_by:M})},...f}),(_=(I=(C=window?.google)===null||C===void 0?void 0:C.accounts)===null||I===void 0?void 0:I.id)===null||_===void 0||_.renderButton(p.current,{type:c,theme:l,size:u,text:m,shape:s,logo_alignment:d,width:b,locale:x,click_listener:g}),r&&((B=(T=(A=window?.google)===null||A===void 0?void 0:A.accounts)===null||T===void 0?void 0:T.id)===null||B===void 0||B.prompt(G.current)),()=>{var v,y,j;r&&((j=(y=(v=window?.google)===null||v===void 0?void 0:v.accounts)===null||y===void 0?void 0:y.id)===null||j===void 0||j.cancel())}},[h,w,r,c,l,u,m,s,d,b,x]),$.createElement("div",{...a,ref:p,style:{height:ae[u],...a?.style}})}class S extends Error{}S.prototype.name="InvalidTokenError";function de(o){return decodeURIComponent(atob(o).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function ce(o){let t=o.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return de(t)}catch{return atob(t)}}function ue(o,t){if(typeof o!="string")throw new S("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=o.split(".")[r];if(typeof n!="string")throw new S(`Invalid token specified: missing part #${r+1}`);let c;try{c=ce(n)}catch(l){throw new S(`Invalid token specified: invalid base64 for part #${r+1} (${l.message})`)}try{return JSON.parse(c)}catch(l){throw new S(`Invalid token specified: invalid json for part #${r+1} (${l.message})`)}}const me=()=>{const o=[{icon:e.jsx(Q,{size:28,className:"text-primary-strong"}),text:"Track real-time market insights"},{icon:e.jsx(X,{size:28,className:"text-primary-strong"}),text:"Secure and reliable trading platform"},{icon:e.jsx(Z,{size:28,className:"text-primary-strong"}),text:"Advanced analytics and reporting"}];return e.jsx("div",{className:"flex-1 flex flex-col justify-center p-12 bg-muted text-card-foreground relative overflow-hidden",children:e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-4xl font-bold mb-10 font-display text-foreground",children:"Welcome to SnoopTrade"}),e.jsx("div",{className:"space-y-6",children:o.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-4 transform transition-transform hover:translate-x-3 duration-300",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/20",children:t.icon}),e.jsx("p",{className:"text-lg text-muted-foreground",children:t.text})]},r))})]})})},fe=({onSubmit:o,error:t})=>{const[r,n]=i.useState(""),[c,l]=i.useState(""),[u,m]=i.useState(!1),[s,d]=i.useState(!1),b=async x=>{x.preventDefault(),d(!0),await o(r,c),d(!1)};return e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"email",className:"text-card-foreground",children:"Email"}),e.jsx(O,{id:"email",type:"email",placeholder:"Enter your email",value:r,onChange:x=>n(x.target.value),required:!0,className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(W,{htmlFor:"password",className:"text-card-foreground",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{id:"password",type:u?"text":"password",placeholder:"Enter your password",value:c,onChange:x=>l(x.target.value),required:!0,className:"h-11 pr-10"}),e.jsx("button",{type:"button",onClick:()=>m(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-primary-strong transition-colors",children:u?e.jsx(oe,{size:20}):e.jsx(re,{size:20})})]})]}),t&&e.jsx("div",{role:"alert",className:"login-error-message bg-destructive/30 border border-destructive text-sm p-3 rounded-md text-center font-medium",children:t}),e.jsx(ee,{type:"submit",disabled:s,className:"w-full h-12 text-base font-semibold",children:s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}),e.jsx("span",{children:"Signing in..."})]}):"Sign In"})]})},q=({onSuccess:o,onError:t})=>{const r=i.useRef(null),[n,c]=i.useState(400),[l,u]=i.useState(0),m=i.useCallback(()=>{if(r.current){const s=Math.floor(r.current.offsetWidth);s>0&&s!==n&&(c(s),u(d=>d+1))}},[n]);return i.useEffect(()=>{m();const s=new ResizeObserver(()=>m());return r.current&&s.observe(r.current),()=>s.disconnect()},[m]),e.jsx("div",{ref:r,className:"w-full",children:e.jsx(le,{onSuccess:o,onError:t,text:"signin_with",shape:"rectangular",theme:"outline",size:"large",width:n},l)})},H="728674119061-9r5tbp1mactot2uf1p7q44bp0g7sg4p5.apps.googleusercontent.com",Ee=()=>{const[o,t]=i.useState(""),r=V(),{token:n,setToken:c,requiresPassword:l,setRequiresPassword:u}=J(),m=async(g,a)=>{try{const f=new URLSearchParams;f.append("username",g),f.append("password",a);const p=await fetch(F.login,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:f.toString()});if(p.ok){const h=await p.json();c(h.access_token),r("/dashboard")}else{const h=await p.json();t(h.detail||"Login failed. Please try again.")}}catch{t("Something went wrong. Please try again.")}},s=async g=>{try{const a=g.credential;if(!a){t("Google token is missing or invalid.");return}const f=ue(a);if(!f.email){t("Google token does not contain email information.");return}const p=new URLSearchParams;p.append("username",f.email),p.append("password",""),p.append("login_type","google"),p.append("token",a);const h=await fetch(F.login,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:p.toString()});if(h.ok){const w=await h.json();c(w.access_token),w.requires_password?(u(!0),r("/create-password")):r("/dashboard")}else{const w=await h.json();t(w.detail||"Google login failed.")}}catch(a){console.error("Error in Google login:",a),t("Something went wrong with Google login.")}},d=()=>{t("Google Login failed.")};if(n&&!l)return e.jsx(z,{to:"/dashboard",replace:!0});if(n&&l)return e.jsx(z,{to:"/create-password",replace:!0});const b=e.jsxs("div",{className:"min-h-screen flex flex-col px-5 pt-12 pb-8 md:hidden",style:{backgroundColor:"#0E1410"},children:[e.jsx(P,{children:e.jsx("title",{children:"Login - SnoopTrade"})}),e.jsxs("div",{className:"mb-8",style:{gap:8},children:[e.jsx("p",{style:{color:"#A7B7AC",fontSize:12,fontWeight:600,marginBottom:8},children:"SnoopTrade"}),e.jsx("h1",{style:{color:"#EAF5EC",fontSize:28,fontWeight:700,marginBottom:8},children:"Welcome back"}),e.jsx("p",{style:{color:"#A7B7AC",fontSize:15},children:"Sign in to track insider activity."})]}),e.jsx(U,{clientId:H,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("div",{className:"mobile-input",children:e.jsx("input",{type:"email",placeholder:"Email",style:{width:"100%",background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15},onKeyDown:g=>{if(g.key==="Enter"){const a=document.getElementById("mobile-password");a&&a.focus()}},id:"mobile-email"})}),e.jsx("div",{className:"mobile-input",children:e.jsx("input",{type:"password",placeholder:"Password",style:{width:"100%",background:"transparent",border:"none",outline:"none",color:"#EAF5EC",fontSize:15},id:"mobile-password",onKeyDown:g=>{if(g.key==="Enter"){const a=document.getElementById("mobile-email"),f=document.getElementById("mobile-password");a?.value&&f?.value&&m(a.value,f.value)}}})}),o&&e.jsx("p",{style:{color:"#E56A6A",fontSize:12,marginTop:4},children:o}),e.jsx("button",{className:"mobile-btn-primary",style:{marginTop:12},onClick:()=>{const g=document.getElementById("mobile-email"),a=document.getElementById("mobile-password");m(g?.value||"",a?.value||"")},children:"Login"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginTop:12},children:[e.jsx("div",{style:{flex:1,height:1,backgroundColor:"#314036"}}),e.jsx("span",{style:{color:"#A7B7AC",fontSize:12},children:"OR"}),e.jsx("div",{style:{flex:1,height:1,backgroundColor:"#314036"}})]}),e.jsx("div",{style:{marginTop:12,width:"100%"},children:e.jsx(q,{onSuccess:s,onError:d})}),e.jsxs("p",{style:{textAlign:"center",marginTop:24,color:"#A7B7AC",fontSize:15},children:["No account yet?"," ",e.jsx(D,{to:"/signup",style:{color:"#B7E389",fontWeight:700,textDecoration:"none"},children:"Sign up"})]})]})})]}),x=e.jsxs("div",{className:"min-h-screen lg:fixed lg:inset-0 lg:h-screen lg:overflow-hidden hidden md:flex flex-col items-center bg-background pt-24 sm:pt-28 md:pt-32 lg:pt-24",children:[e.jsx(P,{children:e.jsx("title",{children:"Login - SnoopTrade"})}),e.jsx(Y,{}),e.jsx(U,{clientId:H,children:e.jsx("div",{className:"animate-in fade-in duration-1000 flex-1 flex flex-col min-h-0 items-center justify-center px-4 py-6 lg:py-4 w-[92%] sm:w-[85%] lg:w-[75%] max-w-[1200px] mb-8 sm:mb-12 lg:mb-0",children:e.jsxs(te,{className:"flex flex-col md:flex-row overflow-hidden rounded-xl sm:rounded-2xl shadow-2xl bg-card border-border max-h-[calc(100vh-8rem)] lg:max-h-[calc(100vh-6rem)]",children:[e.jsx(me,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-5 sm:p-8 md:p-12 bg-card min-h-0 overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-md space-y-4 sm:space-y-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-center text-card-foreground font-display",children:"Login to Your Account"}),e.jsx(fe,{onSubmit:m,error:o}),e.jsxs("div",{className:"flex items-center my-4 sm:my-6",children:[e.jsx("div",{className:"flex-1 border-b border-border"}),e.jsx("span",{className:"px-4 text-sm text-muted-foreground",children:"OR"}),e.jsx("div",{className:"flex-1 border-b border-border"})]}),e.jsx("div",{className:"w-full",children:e.jsx(q,{onSuccess:s,onError:d})}),e.jsxs("p",{className:"text-sm text-center text-muted-foreground mt-4 sm:mt-6",children:["Don't have an account?"," ",e.jsx(D,{to:"/signup",className:"text-primary-strong font-semibold hover:underline transition-all",children:"Sign Up"})]})]})})]})})})]});return e.jsxs(e.Fragment,{children:[b,x]})};export{Ee as default};
