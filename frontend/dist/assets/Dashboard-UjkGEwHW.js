import{j as e,u as Oe,H as Be}from"./index-BdWBpXNs.js";import{r as i,R as ke,u as ze}from"./vendor-router-sBGvKeAa.js";import{N as Ge}from"./Navbar-D2UotZHs.js";import{M as He}from"./MobileBottomNav-CYW5ze22.js";import{c as z,b as P,C as G,d as Ue,e as Ke,a as V,B as O}from"./card-CAAq5ZaP.js";import{R as te,L as We,C as De,X as Ae,Y as _e,T as se,a as ae,b as Q,c as Ve,A as fe,P as Je,d as qe,e as Xe}from"./vendor-charts-P8qmgMGQ.js";import{I as Ye,A as K}from"./apiEndpoints-Cjc9S1sZ.js";import{S as Ze}from"./search-DkVfeeXN.js";import"./trending-up-DXh838HL.js";import"./user-AsS-Y0Xm.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=z("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=z("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=z("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=z("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=z("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]),Pe=i.forwardRef(({className:o,...t},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:P("w-full caption-bottom text-sm",o),...t})}));Pe.displayName="Table";const Me=i.forwardRef(({className:o,...t},s)=>e.jsx("thead",{ref:s,className:P("[&_tr]:border-b",o),...t}));Me.displayName="TableHeader";const Le=i.forwardRef(({className:o,...t},s)=>e.jsx("tbody",{ref:s,className:P("[&_tr:last-child]:border-0",o),...t}));Le.displayName="TableBody";const at=i.forwardRef(({className:o,...t},s)=>e.jsx("tfoot",{ref:s,className:P("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",o),...t}));at.displayName="TableFooter";const W=i.forwardRef(({className:o,...t},s)=>e.jsx("tr",{ref:s,className:P("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",o),...t}));W.displayName="TableRow";const E=i.forwardRef(({className:o,...t},s)=>e.jsx("th",{ref:s,className:P("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",o),...t}));E.displayName="TableHead";const M=i.forwardRef(({className:o,...t},s)=>e.jsx("td",{ref:s,className:P("p-4 align-middle [&:has([role=checkbox])]:pr-0",o),...t}));M.displayName="TableCell";const rt=i.forwardRef(({className:o,...t},s)=>e.jsx("caption",{ref:s,className:P("mt-4 text-sm text-muted-foreground",o),...t}));rt.displayName="TableCaption";const ge=({tradeData:o,rowsPerPage:t,page:s,handleChangePage:l,handleChangeRowsPerPage:p})=>{const[a,y]=i.useState("date"),[c,g]=i.useState("desc"),d=r=>{const h=a===r&&c==="asc";y(r),g(h?"desc":"asc")},m=o.filter(r=>{const h=new Date(r.date),N=new Date;return!isNaN(h.getTime())&&h<=N&&r.date!==null&&r.date!==void 0}),v=r=>({P:"Purchase",S:"Sale",A:"Grant",D:"Sale to Loss",F:"Payment of Exercise",I:"Discretionary Transaction",M:"Exercise/Conversion"})[r]||r,A=r=>({P:"text-emerald-400",S:"text-red-400",A:"text-teal-400",D:"text-amber-400",F:"text-violet-400",I:"text-lime-400",M:"text-cyan-400",G:"text-green-400"})[r]||"text-slate-400",f=[...m].sort((r,h)=>{if(a==="date"){const N=new Date(r.date).getTime(),C=new Date(h.date).getTime();return c==="asc"?N-C:C-N}else{if(a==="shares")return c==="asc"?r.shares-h.shares:h.shares-r.shares;if(a==="price_per_share")return c==="asc"?r.price_per_share-h.price_per_share:h.price_per_share-r.price_per_share;if(a==="transaction_code"){const N=v(r.transaction_code),C=v(h.transaction_code);return c==="asc"?N.localeCompare(C):C.localeCompare(N)}else if(a==="total_value"){const N=r.shares*(r.price_per_share||0),C=h.shares*(h.price_per_share||0);return c==="asc"?N-C:C-N}}return 0}).slice(s*t,s*t+t),S=r=>{const h=new Date(r);return isNaN(h.getTime())?"Invalid Date":h.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},T=Math.ceil(m.length/t);return e.jsxs(G,{className:"w-full bg-card/80 backdrop-blur-sm border-border/50 shadow-lg",children:[e.jsxs(Ue,{className:"space-y-1 pb-4",children:[e.jsx(Ke,{className:"text-2xl font-bold text-card-foreground font-display",children:"Transaction History"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Detailed breakdown of all insider trading transactions"})]}),e.jsxs(V,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Pe,{children:[e.jsx(Me,{children:e.jsxs(W,{className:"border-b border-border/30 hover:bg-transparent",children:[e.jsx(E,{className:"text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>d("date"),className:"flex items-center gap-2 hover:text-primary transition-colors",children:["Date",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(E,{className:"text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>d("transaction_code"),className:"flex items-center gap-2 hover:text-primary transition-colors",children:["Type",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(E,{className:"text-right text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>d("shares"),className:"flex items-center gap-2 ml-auto hover:text-primary transition-colors",children:["Shares",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(E,{className:"text-right text-card-foreground font-semibold hidden sm:table-cell",children:e.jsxs("button",{onClick:()=>d("price_per_share"),className:"flex items-center gap-2 ml-auto hover:text-primary transition-colors",children:["Price/Share",e.jsx(R,{className:"h-4 w-4"})]})}),e.jsx(E,{className:"text-right text-card-foreground font-semibold",children:e.jsxs("button",{onClick:()=>d("total_value"),className:"flex items-center gap-2 ml-auto hover:text-primary transition-colors",children:["Total Value",e.jsx(R,{className:"h-4 w-4"})]})})]})}),e.jsx(Le,{children:f.length>0?f.map((r,h)=>e.jsxs(W,{className:"border-b border-border/20 hover:bg-primary/5 transition-colors",children:[e.jsx(M,{className:"font-medium text-card-foreground/90",children:S(r.date)}),e.jsx(M,{children:e.jsx("span",{className:`font-semibold ${A(r.transaction_code)}`,children:v(r.transaction_code)})}),e.jsx(M,{className:"text-right text-card-foreground/80 font-mono",children:r.shares?.toLocaleString()||"N/A"}),e.jsxs(M,{className:"text-right text-card-foreground/80 font-mono hidden sm:table-cell",children:["$",r.price_per_share?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})||"N/A"]}),e.jsxs(M,{className:"text-right font-semibold text-primary-strong font-mono",children:["$",(r.shares*(r.price_per_share||0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},h)):e.jsx(W,{children:e.jsx(M,{colSpan:5,className:"text-center text-muted-foreground py-12",children:"No transaction data available."})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-6 py-4 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Rows per page:"}),e.jsx("select",{value:t,onChange:r=>{const h={target:{value:r.target.value}};p(h)},className:"bg-card text-card-foreground border border-border/50 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-primary",children:[5,10,25,50].map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s+1," of ",T||1," (",m.length," total)"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{variant:"ghost",size:"icon",onClick:r=>l(r,0),disabled:s===0,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(tt,{className:"h-4 w-4"})}),e.jsx(O,{variant:"ghost",size:"icon",onClick:r=>l(r,s-1),disabled:s===0,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(O,{variant:"ghost",size:"icon",onClick:r=>l(r,s+1),disabled:s>=T-1,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(et,{className:"h-4 w-4"})}),e.jsx(O,{variant:"ghost",size:"icon",onClick:r=>l(r,T-1),disabled:s>=T-1,className:"h-8 w-8 text-card-foreground hover:text-primary hover:bg-primary/10 disabled:opacity-30",children:e.jsx(st,{className:"h-4 w-4"})})]})]})]})]})]})},B=ke.memo(({title:o,data:t,dataKey:s,lineColor:l,isLogScale:p})=>{const[a,y]=i.useState(window.matchMedia("(max-width: 767px)").matches);return i.useEffect(()=>{const c=window.matchMedia("(max-width: 767px)"),g=d=>y(d.matches);return c.addEventListener("change",g),()=>c.removeEventListener("change",g)},[]),e.jsx(G,{className:"p-3 md:p-6 bg-card border-border shadow-md",children:e.jsxs(V,{className:"p-0",children:[e.jsx("h3",{className:"text-base md:text-2xl font-semibold mb-3 md:mb-6 text-card-foreground font-display",children:o}),e.jsx(te,{width:"100%",height:a?260:400,children:e.jsxs(We,{data:t,children:[e.jsx(De,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(Ae,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:a?10:12},tickFormatter:a?c=>{const g=c.split(" ");return g.length>=2?`${g[0].substring(0,3)} ${g[g.length-1].substring(2)}`:c}:void 0}),e.jsx(_e,{scale:p?"log":"auto",domain:p?["auto","auto"]:void 0,stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:a?10:12},width:a?40:60}),e.jsx(se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",color:"hsl(var(--card-foreground))"},itemStyle:{color:"hsl(var(--card-foreground))"},labelStyle:{color:"hsl(var(--card-foreground))"}}),e.jsx(ae,{wrapperStyle:{color:"hsl(var(--card-foreground))"}}),e.jsx(Q,{type:"monotone",dataKey:s,stroke:l,strokeWidth:2,dot:!1})]})})]})})});B.displayName="ChartContainer";const ee=ke.memo(({title:o,data:t,dataKey:s,lineColor:l,isLogScale:p,additionalLines:a=[],areaDataKeyLower:y,areaDataKeyUpper:c})=>{const[g,d]=i.useState(window.matchMedia("(max-width: 767px)").matches);i.useEffect(()=>{const x=window.matchMedia("(max-width: 767px)"),f=S=>d(S.matches);return x.addEventListener("change",f),()=>x.removeEventListener("change",f)},[]);const m=i.useMemo(()=>{if(!t||t.length===0)return null;const x=t[0],f=t[t.length-1],S=x?.[s]??0,T=f?.[s]??0,r=S>0?(T-S)/S*100:0,h=r>1?"bullish":r<-1?"bearish":"neutral",N=x?.insider_signal??0,C=N>.2?"Insider Buying":N<-.2?"Insider Selling":"Neutral";return{startPrice:S.toFixed(2),endPrice:T.toFixed(2),pctChange:r.toFixed(1),direction:h,insiderLabel:C,insiderSignal:N,days:t.length}},[t,s]),v=i.useMemo(()=>!t||!y||!c?t:t.map(x=>({...x,_bandRange:[x[y],x[c]]})),[t,y,c]),A=m?.direction==="bullish"?"#22c55e":m?.direction==="bearish"?"#ef4444":"hsl(var(--muted-foreground))";return e.jsx(G,{className:"p-3 md:p-6 bg-card border-border shadow-md",children:e.jsxs(V,{className:"p-0",children:[e.jsx("h3",{className:"text-base md:text-2xl font-semibold mb-2 md:mb-4 text-card-foreground font-display",children:o}),m&&e.jsxs("div",{className:"flex flex-wrap gap-3 md:gap-6 mb-3 md:mb-5 text-xs md:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Predicted:"}),e.jsxs("span",{className:"font-semibold text-card-foreground",children:["$",m.endPrice]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Change:"}),e.jsxs("span",{className:"font-semibold",style:{color:A},children:[Number(m.pctChange)>0?"+":"",m.pctChange,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:A}}),e.jsx("span",{className:"font-medium capitalize",style:{color:A},children:m.direction})]}),m.insiderSignal!==0&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Insider:"}),e.jsx("span",{className:"font-medium",style:{color:m.insiderSignal>0?"#22c55e":"#ef4444"},children:m.insiderLabel})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsxs("span",{className:"text-muted-foreground",children:[m.days,"-day forecast"]})})]}),e.jsx(te,{width:"100%",height:g?260:400,children:e.jsxs(Ve,{data:v,children:[e.jsx(De,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(Ae,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:g?10:12},tickFormatter:g?x=>{const f=x.split(" ");return f.length>=2?`${f[0].substring(0,3)} ${f[f.length-1].substring(2)}`:x}:void 0}),e.jsx(_e,{scale:p?"log":"auto",domain:p?["auto","auto"]:["dataMin - 5","dataMax + 5"],stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))",fontSize:g?10:12},width:g?50:70,tickFormatter:x=>`$${x.toFixed(0)}`}),e.jsx(se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",color:"hsl(var(--card-foreground))"},itemStyle:{color:"hsl(var(--card-foreground))"},labelStyle:{color:"hsl(var(--card-foreground))"},formatter:(x,f)=>{const S=f===s?"Predicted":f==="trend"?"Trend":f;return[`$${x.toFixed(2)}`,S]}}),e.jsx(ae,{wrapperStyle:{color:"hsl(var(--card-foreground))"}}),y&&c&&e.jsxs(e.Fragment,{children:[e.jsx(fe,{type:"monotone",dataKey:c,stroke:"none",fill:l,fillOpacity:.12,name:"Upper Bound",legendType:"none"}),e.jsx(fe,{type:"monotone",dataKey:y,stroke:"none",fill:"hsl(var(--card))",fillOpacity:1,name:"Lower Bound",legendType:"none"})]}),e.jsx(Q,{type:"monotone",dataKey:s,stroke:l,strokeWidth:3,dot:!1,name:"Predicted Price"}),a.map((x,f)=>e.jsx(Q,{type:"monotone",dataKey:x.dataKey,stroke:x.lineColor,strokeWidth:2,strokeDasharray:"5 5",dot:!1,name:x.title},f))]})})]})})});ee.displayName="ForecastChartContainer";const ot=({searchTerm:o,onSearchChange:t})=>e.jsxs("div",{className:"relative w-full max-w-2xl mx-auto",children:[e.jsx(Ze,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",size:20}),e.jsx(Ye,{type:"text",placeholder:"Search for a company...",value:o,onChange:t,className:"pl-12 h-14 text-lg bg-card border-border focus:ring-2 focus:ring-primary"})]});function nt(o){const t="pk_ch_0yAQ0RdqVUu60Kkk4bg";return o?`https://img.logo.dev/ticker/${encodeURIComponent(o.toUpperCase())}?token=${encodeURIComponent(t)}`:null}const Ee=({ticker:o,size:t=32,className:s=""})=>{const[l,p]=i.useState(!1),a=nt(o),y=!a||l,c=o?o[0].toUpperCase():"?",g={width:t,height:t};return y?e.jsx("span",{className:`inline-flex items-center justify-center rounded-full bg-muted text-muted-foreground font-semibold shrink-0 ${s}`,style:g,"aria-hidden":!0,children:c}):e.jsx("img",{src:a,alt:"",className:`rounded-full object-contain shrink-0 ${s}`,style:g,onError:()=>p(!0)})},it=({companies:o,companyNames:t={},onSelectCompany:s})=>e.jsx(G,{className:"w-full max-w-2xl mx-auto bg-card border-border shadow-lg",children:e.jsx("ul",{className:"divide-y divide-border",children:o.map(l=>{const p=t[l]?`${l} (${t[l]})`:l;return e.jsx("li",{children:e.jsxs("button",{onClick:()=>s(l),className:"w-full px-6 py-4 flex items-center gap-3 text-left text-card-foreground hover:bg-muted transition-colors duration-150 cursor-pointer text-lg font-medium",children:[e.jsx(Ee,{ticker:l,size:28}),p]})},l)})})}),be={G:"Gift",S:"Sale",M:"Exercise/Conversion",F:"Payment of Exercise",A:"Grant/Award",P:"Purchase",D:"Sale to Issuer",I:"Discretionary"},je=({title:o,data:t,dataKey:s,nameKey:l,colors:p})=>{const[a,y]=i.useState(window.matchMedia("(max-width: 767px)").matches);i.useEffect(()=>{const d=window.matchMedia("(max-width: 767px)"),m=v=>y(v.matches);return d.addEventListener("change",m),()=>d.removeEventListener("change",m)},[]);const c=({cx:d,cy:m,midAngle:v,innerRadius:A,outerRadius:x,value:f,index:S})=>{const T=Math.PI/180,r=x*1.2,h=d+r*Math.cos(-v*T),N=m+r*Math.sin(-v*T);return e.jsx("text",{x:h,y:N,fill:"hsl(var(--card-foreground))",textAnchor:h>d?"start":"end",dominantBaseline:"central",className:"text-sm font-medium",children:f.toLocaleString()})},g=d=>be[d]||d;return e.jsx(G,{className:"p-3 md:p-6 bg-card/80 backdrop-blur-sm border-border/50 shadow-lg hover:shadow-xl transition-shadow duration-300",children:e.jsxs(V,{className:"p-0",children:[e.jsx("h3",{className:"text-sm md:text-xl font-semibold mb-2 md:mb-4 text-card-foreground font-display",children:o}),e.jsx(te,{width:"100%",height:a?260:350,children:e.jsxs(Je,{children:[e.jsx("defs",{children:p.map((d,m)=>e.jsxs("linearGradient",{id:`gradient-${m}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:d,stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:d,stopOpacity:.7})]},`gradient-${m}`))}),e.jsx(qe,{data:t,dataKey:s,nameKey:l,cx:"50%",cy:"50%",innerRadius:a?40:60,outerRadius:a?70:100,paddingAngle:3,label:a?!1:c,labelLine:a?!1:{stroke:"hsl(var(--muted-foreground))",strokeWidth:1},animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:t.map((d,m)=>e.jsx(Xe,{fill:`url(#gradient-${m%p.length})`,stroke:"hsl(var(--card))",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"}},`cell-${m}`))}),e.jsx(se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"12px",color:"hsl(var(--card-foreground))",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",padding:"12px 16px"},itemStyle:{color:"hsl(var(--card-foreground))"},formatter:(d,m)=>[d.toLocaleString(),be[m]||m],labelStyle:{color:"hsl(var(--muted-foreground))"}}),e.jsx(ae,{verticalAlign:"bottom",height:36,formatter:g,wrapperStyle:{color:"hsl(var(--card-foreground))",paddingTop:"20px"},iconType:"circle",iconSize:10})]})})]})})},ye=["hsl(142, 70%, 45%)","hsl(160, 55%, 40%)","hsl(142, 45%, 35%)","hsl(175, 50%, 38%)","hsl(130, 50%, 45%)","hsl(155, 60%, 32%)","hsl(140, 40%, 55%)"],ve=({tradeData:o})=>{const t=o.reduce((l,p)=>{const a=l.find(y=>y.name===p.transaction_code);return a?a.value+=1:l.push({name:p.transaction_code,value:1}),l},[]),s=o.reduce((l,p)=>{const a=l.find(y=>y.name===p.transaction_code);return a?a.value+=p.shares:l.push({name:p.transaction_code,value:p.shares}),l},[]);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8",children:[e.jsx(je,{title:"Transaction Types Distribution",data:t,dataKey:"value",nameKey:"name",colors:ye}),e.jsx(je,{title:"Shares Distribution",data:s,dataKey:"value",nameKey:"name",colors:ye})]})},Ne=async(o,t)=>{const s=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Error ${s.status}: ${s.statusText}`);return s.json()},Z={"1M":"1m","3M":"3m","6M":"6m","1Y":"1y"},we=["AAPL","META","NVDA","GOOGL","MSFT","AMZN","TSLA","NFLX","JPM","JNJ","V","UNH","HD","DIS","BAC","XOM","PG","MA","PEP","WMT"],$={AAPL:"Apple Inc.",META:"Meta Platforms",NVDA:"NVIDIA",GOOGL:"Alphabet (Google)",MSFT:"Microsoft",AMZN:"Amazon",TSLA:"Tesla",NFLX:"Netflix",JPM:"JPMorgan Chase",JNJ:"Johnson & Johnson",V:"Visa",UNH:"UnitedHealth",HD:"Home Depot",DIS:"Walt Disney",BAC:"Bank of America",XOM:"Exxon Mobil",PG:"Procter & Gamble",MA:"Mastercard",PEP:"PepsiCo",WMT:"Walmart"},D={price:"hsl(var(--primary-strong))",volume:"hsl(var(--accent))",forecast:"#ef4444",trend:"#f97316",seasonal:"#3b82f6"},lt=12e4,Ce=new Map,Se=new Map;function Te(o,t){const s=o.get(t);return s&&Date.now()-s.ts<lt?s.data:(o.delete(t),null)}function ct(){const o=new Date().getHours();return o<12?"Good morning":o<17?"Good afternoon":"Good evening"}function dt(o){return o?o.split(" ").slice(0,2).map(t=>t[0]?.toUpperCase()||"").join(""):"?"}const vt=o=>{const[t,s]=i.useState(""),[l,p]=i.useState(!1),[a,y]=i.useState(null),[c,g]=i.useState(Z["1Y"]),[d,m]=i.useState([]),[v,A]=i.useState([]),[x,f]=i.useState(0),[S,T]=i.useState(10),[r,h]=i.useState([]),[N]=i.useState(!1),[C]=i.useState(!1),[H,re]=i.useState(!1),[oe,ne]=i.useState(!1),[U,J]=i.useState(""),ie=ze(),{token:k,setToken:le}=Oe(),[ce,de]=i.useState("");i.useRef(null),i.useEffect(()=>{k&&fetch(K.getUserDetails,{headers:{Authorization:`Bearer ${k}`}}).then(n=>n.ok?n.json():null).then(n=>{n?.name?de(n.name):n?.first_name&&de(n.first_name)}).catch(()=>{})},[k]);const I=i.useMemo(()=>{const n=t.toLowerCase().trim();return n?we.filter(u=>{const w=($[u]??"").toLowerCase();return u.toLowerCase().includes(n)||w.includes(n)}):we},[t]);i.useEffect(()=>{p(t.length>0)},[t]);const me=i.useCallback(n=>{y(n),s(""),p(!1),ne(!1),J("")},[]),he=i.useCallback(n=>{g(n)},[]),xe=i.useCallback(async()=>{if(!a||!k)return;const n=`${a}:${c}`,u=Te(Ce,n);if(u){m(u);return}try{const w=K.getStocks(a,c),F=(await Ne(w,k)).filter(j=>j.date).map(j=>{const b=new Date(j.date);return{date:b.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),dateISO:b.toISOString().split("T")[0],open:j.open??0,close:j.close??0,high:j.high??0,low:j.low??0}}).sort((j,b)=>new Date(j.dateISO).getTime()-new Date(b.dateISO).getTime());Ce.set(n,{data:F,ts:Date.now()}),m(F)}catch(w){console.error("Error fetching stock data:",w),w.message.includes("401")&&(le(null),ie("/login"))}},[a,c,k,le,ie]),ue=i.useCallback(async(n,u)=>{if(!n||n.length===0){console.error("No formatted data available for forecasting");return}re(!0),J("");try{const w=n.map(j=>({date:j.dateISO??new Date(j.date).toISOString().split("T")[0],open:j.open,high:j.high,low:j.low,close:j.close})),L=await fetch(K.fetchFutureData(u),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify(w)});if(!L.ok){const b=(await L.json().catch(()=>({}))).detail??`Error from forecast API: ${L.statusText}`;throw new Error(typeof b=="string"?b:JSON.stringify(b))}const F=await L.json();h(F),ne(!0)}catch(w){console.error("Error during forecasting:",w),J(w?.message??"Failed to load forecast. Please try again.")}finally{re(!1)}},[k]),pe=i.useCallback(async()=>{if(!a||!k)return;const n=`${a}:${c}`,u=Te(Se,n);if(u){A(u);return}try{const w=K.getTransactions(a,c),j=(await Ne(w,k)).filter(b=>{const Y=new Date(b.transaction_date);return!isNaN(Y.getTime())}).map(b=>({filing_date:b.filing_date,date:b.transaction_date,formatted_date:new Date(b.transaction_date).toLocaleDateString("en-US"),shares:Number(b.shares)||0,transaction_code:b.transaction_code,price_per_share:b.price_per_share,ownership_type:b.ownership_type,issuer_name:b.issuer_name,security_title:b.security_title})).sort((b,Y)=>new Date(Y.date).getTime()-new Date(b.date).getTime());Se.set(n,{data:j,ts:Date.now()}),A(j)}catch(w){console.error("Error fetching insider trade data:",w)}},[a,c,k]);i.useEffect(()=>{k&&a&&(xe(),pe())},[xe,pe,k,a]);const _=d.length?d[d.length-1]:null,q=v.filter(n=>n.transaction_code==="P").length,X=v.filter(n=>n.transaction_code==="S").length,Ie=q>X?"mildly bullish":X>q?"cautious":"neutral",Fe=dt(ce),Re=e.jsxs("div",{className:"md:hidden has-bottom-nav",style:{backgroundColor:"#0E1410",minHeight:"100vh"},children:[e.jsxs("div",{style:{padding:"16px 20px",display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,paddingTop:8,paddingBottom:8},children:[e.jsx("div",{className:"mobile-avatar",children:Fe}),e.jsxs("div",{children:[e.jsx("p",{style:{color:"#A7B7AC",fontSize:12},children:ct()}),e.jsx("p",{style:{color:"#EAF5EC",fontSize:22,fontWeight:700},children:ce||"Trader"})]})]}),e.jsx("input",{className:"mobile-input",placeholder:"Search ticker or company...",value:t,onChange:n=>s(n.target.value),style:{textTransform:"uppercase"}}),l&&I.length>0&&e.jsx("div",{className:"mobile-card",style:{padding:8,maxHeight:200,overflowY:"auto"},children:I.map(n=>e.jsxs("button",{onClick:()=>me(n),style:{display:"block",width:"100%",textAlign:"left",padding:"10px 12px",color:"#EAF5EC",fontSize:14,background:"transparent",border:"none",cursor:"pointer",borderRadius:8},onMouseOver:u=>u.currentTarget.style.backgroundColor="#253129",onMouseOut:u=>u.currentTarget.style.backgroundColor="transparent",children:[e.jsx("span",{style:{fontWeight:700},children:n}),e.jsx("span",{style:{color:"#A7B7AC",marginLeft:8},children:$[n]})]},n))}),a&&e.jsxs("div",{className:"mobile-chip",children:[e.jsx("div",{className:"dot"}),e.jsx("span",{className:"ticker",children:a}),e.jsx("span",{className:"name",children:$[a]||a})]}),a&&e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:Object.entries(Z).map(([n,u])=>e.jsx("button",{className:`mobile-filter-chip ${c===u?"active":""}`,onClick:()=>he(u),children:n},u))}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mobile-card mobile-card-shadow",children:e.jsx(B,{title:`Stock Price (${c.toUpperCase()})`,data:d,dataKey:"open",lineColor:D.price,isLogScale:C})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"Open"}),e.jsx("div",{className:"value",children:_?`$${Number(_.open).toFixed(2)}`:"--"})]}),e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"Close"}),e.jsx("div",{className:"value",children:_?`$${Number(_.close).toFixed(2)}`:"--"})]}),e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"High"}),e.jsx("div",{className:"value",children:_?`$${Number(_.high).toFixed(2)}`:"--"})]}),e.jsxs("div",{className:"mobile-summary-card",children:[e.jsx("div",{className:"label",children:"Low"}),e.jsx("div",{className:"value",children:_?`$${Number(_.low).toFixed(2)}`:"--"})]})]}),e.jsxs("div",{className:"mobile-snapshot",children:[e.jsx("div",{className:"title",children:"Insider Snapshot"}),e.jsxs("div",{style:{display:"flex",gap:24},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:4,backgroundColor:"#68D08E"}}),e.jsxs("span",{style:{color:"#A7B7AC",fontSize:15},children:["Purchases: ",q]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:4,backgroundColor:"#E56A6A"}}),e.jsxs("span",{style:{color:"#A7B7AC",fontSize:15},children:["Sales: ",X]})]})]}),e.jsxs("p",{style:{color:"#64C9A8",fontSize:15,fontWeight:600,marginTop:12},children:["Net signal: ",Ie]})]}),e.jsx("button",{className:"mobile-btn-primary",onClick:()=>ue(d,a??void 0),disabled:H,children:H?"Predicting...":"Predict Future Trends"}),U&&e.jsx("p",{style:{color:"#E56A6A",fontSize:12,textAlign:"center"},children:U}),oe&&e.jsx("div",{id:"forecast",className:"mobile-card mobile-card-shadow",children:e.jsx(ee,{title:"Predicted Stock Price Trends",data:r,dataKey:"open",lineColor:D.forecast,isLogScale:C,additionalLines:[{dataKey:"trend",lineColor:D.trend,title:"Trend"},{dataKey:"seasonal",lineColor:D.seasonal,title:"Seasonal"}],areaDataKeyLower:"yhat_lower",areaDataKeyUpper:"yhat_upper"})}),e.jsx("div",{className:"mobile-card mobile-card-shadow",children:e.jsx(B,{title:"Volume of Shares Traded",data:v,dataKey:"shares",lineColor:D.volume,isLogScale:N})}),e.jsx("div",{className:"mobile-card mobile-card-shadow",children:e.jsx(ve,{tradeData:v})}),e.jsxs("div",{id:"transactions",children:[e.jsx("h3",{style:{color:"#EAF5EC",fontSize:22,fontWeight:700,textAlign:"center",marginBottom:16},children:"Transaction Details"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsx(ge,{tradeData:v,rowsPerPage:S,page:x,handleChangePage:(n,u)=>f(u),handleChangeRowsPerPage:n=>T(parseInt(n.target.value,10))})})]})]})]}),e.jsx(He,{})]}),$e=e.jsxs("div",{className:"min-h-screen bg-background text-foreground hidden md:block",children:[e.jsx(Be,{children:e.jsx("title",{children:"Dashboard | SnoopTrade"})}),e.jsx(Ge,{}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 pt-24 sm:pt-28 md:pt-32 pb-12 sm:pb-16",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-extrabold text-center mb-4 sm:mb-6 font-display text-foreground",children:["Insider Trading ",e.jsx("span",{className:"text-primary-strong",children:"Dashboard"})]}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl text-center text-muted-foreground mb-10 sm:mb-12 md:mb-16 max-w-3xl mx-auto px-4",children:"Analyze market trends and insider trading activities with real-time data and insights."}),e.jsxs("div",{className:"flex flex-col items-center mt-6 sm:mt-8 space-y-4",children:[e.jsx(ot,{searchTerm:t,onSearchChange:n=>s(n.target.value)}),l&&I.length>0&&e.jsx(it,{companies:I,companyNames:$,onSelectCompany:me}),l&&I.length===0&&e.jsx("p",{className:"text-muted-foreground mt-4 text-sm sm:text-base",children:"No companies found."}),a&&e.jsx("div",{className:"flex justify-center mt-6 sm:mt-8 w-full px-2",children:e.jsx("div",{className:"time-range-row inline-flex rounded-xl border border-border bg-muted/30 p-1 shadow-inner",role:"group","aria-label":"Stock data range",children:Object.entries(Z).map(([n,u])=>{const w=c===u;return e.jsx("button",{type:"button",onClick:()=>he(u),className:`
                        relative px-4 py-2.5 text-sm font-medium rounded-lg
                        transition-all duration-200 ease-out
                        min-w-[4rem] whitespace-nowrap
                        focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background
                        ${w?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}
                      `,"aria-pressed":w,children:n},u)})})})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-center mt-10 sm:mt-12 mb-6 sm:mb-8 font-display text-foreground px-4 flex items-center justify-center gap-3 flex-wrap",children:[e.jsx(Ee,{ticker:a,size:40}),e.jsxs("span",{children:["Data for ",a," (",$[a]??a,")"]})]}),e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(B,{title:"Stock Price Trends",data:d,dataKey:"open",lineColor:D.price,isLogScale:C})}),e.jsx("div",{className:"flex justify-center mb-6 sm:mb-8 px-4",children:e.jsx(O,{onClick:()=>ue(d,a??void 0),disabled:H,className:"w-full sm:w-auto px-6 sm:px-8 h-12 sm:h-auto sm:py-3 text-base sm:text-lg font-semibold",children:H?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-primary-foreground/30 border-t-primary-foreground rounded-full animate-spin"}),e.jsx("span",{children:"Predicting..."})]}):"Predict Future Trends"})}),U&&e.jsx("div",{className:"mb-6 px-4 py-3 rounded-md bg-destructive/10 text-destructive-foreground text-sm text-center",role:"alert",children:U}),oe&&e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(ee,{title:"Predicted Stock Price Trends",data:r,dataKey:"open",lineColor:D.forecast,isLogScale:C,additionalLines:[{dataKey:"trend",lineColor:D.trend,title:"Trend"},{dataKey:"seasonal",lineColor:D.seasonal,title:"Seasonal"}],areaDataKeyLower:"yhat_lower",areaDataKeyUpper:"yhat_upper"})}),e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(B,{title:"Volume of Shares Traded",data:v,dataKey:"shares",lineColor:D.volume,isLogScale:N})}),e.jsx("div",{className:"mb-8 sm:mb-10",children:e.jsx(ve,{tradeData:v})}),e.jsxs("div",{className:"mt-10 sm:mt-12",children:[e.jsx("h3",{className:"text-2xl sm:text-3xl font-semibold text-center mb-4 sm:mb-6 font-display text-foreground px-4",children:"Transaction Details"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(ge,{tradeData:v,rowsPerPage:S,page:x,handleChangePage:(n,u)=>f(u),handleChangeRowsPerPage:n=>T(parseInt(n.target.value,10))})})]})]})]})]});return e.jsxs(e.Fragment,{children:[Re,$e]})};export{vt as default};
